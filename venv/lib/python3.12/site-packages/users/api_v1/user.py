from users.logic.business import create_user
from users.schemas.user import UserSchema

from ripozo.decorators import apimethod
from ripozo.resources.resource_base import ResourceBase


class UserResource(ResourceBase):
    resource_name = "user"

    @apimethod(methods=['POST'])
    @classmethod
    def create_user(cls, request):
        schema = UserSchema()
        user_data, errors = schema.load(request.body_args)
        
        if errors:
            return cls(status_code=400, data={"errors": errors})
        
        create_user(user_data)
        return cls(status_code=201, data={"message": "User created successfully"})
